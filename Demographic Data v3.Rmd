---
title: "The Demographics of Preschool Spots Funded by First 5 Ventura"
author: "Gwendolyn Reynolds"
date: "April 2018"
output:
  word_document:
    reference_docx: ~/Github/SI_Project_Template/template_files/report_template/mystyles.docx
    fig_width: 6 
    fig_height: 4 
  html_document:
    df_print: paged
mainfont: Roboto
---




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load packages 
library(knitr)
library(readxl)
library(scales)
library(anonymizer)
library(lubridate)
library(forcats)
library(sorensonimpact)
library(tidyverse)

si_ggplot_theme_update() 
theme_update(text = element_text(family = "Roboto"), axis.text = element_text(family = "Roboto"), strip.text = element_text(family = "Roboto"), axis.text.x = element_text(angle = 45, hjust = 1))

```


```{r read in data, include=FALSE, warning=FALSE, message=FALSE}

# import_member <- read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Clients with Preschool Services by Year.xls")
# family_intake <- read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Family Intakes 2014-2018.xls")
# preschool <- read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Clients with Preschool Services by Year.xls")
ziptocity <- read_csv("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/zipcodeCity.csv")

oldform <-  read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Old Intake Export 2014-2018.xls")
family <-  read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Family Intake Data FY 2014-2018.xls")
missing <-  read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Missing Family Intake 2014-2018.xls")

kids14 <- read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Children with Preschool Services 2014-15.xls")
kids15 <- read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Children with Preschool Services 2015-2016.xls")
kids16 <- read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Children with Preschool Services 2016-2017.xls")
kids17 <- read_xls("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/Children with Preschool Services FY2017-2018.xls")

```

```{r clean and merge, echo=FALSE, include=FALSE, warning=FALSE, message=FALSE}

# kids14 <- kids14 %>% 
#   mutate(school_year = "2014-2015")
# 
# kids15 <- kids15 %>% 
#   mutate(school_year = "2015-2016")
# 
# kids16 <- kids16 %>% 
#   mutate(school_year = "2016-2017")
# 
# kids17 <- kids17 %>% 
#   mutate(school_year = "2017-2018")
# 
# missing <- missing %>% mutate(wherelive = `01-10: 10 Where does your family currently live?`) %>%
# rename(education = "01-1: 1 What is your highest level of education",
#   wherelive = "01-10: 10 Where does your family currently live?" ,
#   employment = "01-2: 2 What is your current employment status?"    ,
#   maritalstatus = "01-3: 3 What is the marital status of the adults?"    ,
#   income = "01-4: 4 What was your total FAMILY INCOME in the last 12 months?",
#   smoke = "01-5: 5 Does anyone in your household smoke?"   ,
#   childrenhouse = "01-6: 6 How many children in your household are 0-5 years old?"  ,
#   householdmems = "01-7: 7 How many family members live in your household? (incl_ a",
#   health = "01-8: 8 Do all family members in your home have health coverage" ,
#   pregmom = "01-9: 9 Is there an expectant mother in the home?",
#   ProgramTitle = `Program Title`)
# 
# family <- family %>%
#   group_by(FamilyID, ClientID, `Assessment Date`, Question) %>%
#   select(-`Answer Value`, -`Answer Memo`) %>%
#   mutate(dups = n()) %>%
#   mutate(rank = rank(row_number())) %>%
#   select(-dups)
# 
# 
# familyspread <- spread(family, Question, Answer)
# 
# familyspread <- familyspread %>%
#   rename(health = `Do all family members in your home have health coverage such as insurance throuhg work, MediCal (Gold Coast), or other insurance?`,
#          smoke = `Does anyone in your household smoke?`,
#          childrenhouse = `How many children in your household are 0-5 years old?`,
#          householdmems = `How many family members live in your household? (incl. all)`,
#          pregmom = `Is there an expectant mother in the home?`,
#          maritalstatus = `What is the marital status of the adults?`,
#          employment = `What is your current employment status?`,
#          education = `What is your highest level of education`,
#          income = `What was your total FAMILY INCOME in the last 12 months?`,
#          wherelive = `Where does your family currently live?`) %>%
#   distinct() %>%
#   rename(ProgramTitle = `Client Program Title`)
# 
# newfamily <- bind_rows(missing, familyspread)
# 
# oldform <- oldform %>%
#   select(-`Answer Memo`) %>%
#   mutate(Answer2 = ifelse(is.na(Answer), `Answer Value`, Answer)) %>%
#   select(-Answer, -`Answer Value`)
# 
# oldform <- oldform %>%
#   group_by(FamilyID, ClientID, `Assessment Date`, Question) %>%
#   mutate(dups = n()) %>%
#   mutate(rank = rank(row_number())) %>%
#   select(-dups)
# 
# oldformspread <- spread(oldform, Question, Answer2)
# 
# oldformspread <- oldformspread %>%
#   rename(marital = `Marital status?`,
#          employment = `Employment status?`,
#          education = `Have high school diploma/GED?`,
#          income = `Income Level`,
#          childrenhouse = `Total # of children in house between 0-5`,
#          householdmems = `Total # of family members in house`) %>%
#   select(1:12, marital, employment, education, income, childrenhouse, householdmems) %>%
#   rename(`ProgramTitle` = `Client Program Title`)
# 
# familycombined <- bind_rows(newfamily, oldformspread)
# 
# familycombined <- familycombined %>%
#   select(-`Contract Number`, -`Client Type`, -`Enrollment Date`, -LastServiceDate, -`Assessment Entered By`, -rank) %>%
#   distinct()
# 
# kids14 <- kids14 %>%
#   select(-X__1)
# 
# kids15 <- kids15 %>%
#   select(-X__1, -X__2)
# 
# kids16 <- kids16 %>%
#   select(-X__1, -X__2)
# 
# kids17 <- kids17 %>%
#   select(-X__1)
# 
# kidsappend <- bind_rows(kids14, kids15)
# kidsappend <- bind_rows(kidsappend, kids16)
# kidsappend <- bind_rows(kidsappend, kids17)
# 
# kidsappend <- kidsappend %>%
#   select(-16:-20)
# 
# preschool <- kidsappend
# 
# family_intake <- familycombined
# ```
# 
# ```{r}
# 
# ## get the dates in the same format
# preschool$`Enrollment Date_` <- as.Date(preschool$`Enrollment Date_`, "%m/%d/%Y")
# #preschool$`Exited Date` <- as.Date(preschool$`Service EndDate`, "%m/%d/%Y")
# 
# ##I want to know the year of enrollment, so i'm creating a "year" variable
# # preschool <- preschool %>%
# #   mutate(school_year = year(`Enrollment Date_`))
# 
# ## this dataset has a bunch of repeat rows. I want to filter those out.
# # preschool <- preschool %>%
# #   group_by(`Program Title`, ClientID, Zip, school_year) %>%
# #   mutate(count = n()) %>%
# #   mutate(rank = rank(`Enrollment Date_`)) %>%
# #   filter(rank==1)
# 
# preschool <- preschool %>%
#   group_by(`Program Title`, ClientID, Zip, school_year) %>%
#   mutate(count = n()) %>%
#   mutate(rank = rank(`Enrollment Date_`))
# 
# ### collapse all ethnicities besides white/latino/other
# preschool <- preschool %>%
#     mutate(Ethnicity = as.factor(Ethnicity))
# 
# preschool <- preschool %>%
#     mutate(Ethnicity= (fct_collapse(Ethnicity, "Other" = c("01. Alaskan Native / American Indian", "02. Asian", "03. Black / African American", "05. Vietnamese", "06. Pacific Islander", "08. Multiracial", "09. Other", "10. Don't know/Declined"))))
# 
# 
# preschool <- preschool %>%
#     mutate(Language= (fct_collapse(Language, "Other" = c("03. Mixteco", "05. Vietnamese", "07. Mandarin (Putonghua)", "09. Filipino(Tagalog)", "10. Other", "11. Arabic", "13. Chinese", "15. Unknown", "16. Decline to Answer", "06. Korean", "14. Other", "08. Farsi (Persian)", "12. Cambodian", "04. Hmong", "11. Don't Know/Declined"))))
# 
# family_intake$Assessment_Date <- as.Date(family_intake$Assessment_Date, "%m/%d/%Y")
# 
# ##I want to know the year of enrollment, so i'm creating a "year" variable
# family_intake <- family_intake %>%
#   mutate(school_year = year(`Assessment_Date`))
# 
# family_intake <- family_intake %>%
#   group_by(`ProgramTitle`, ClientID, Zip, school_year) %>%
#   mutate(count = n()) %>%
#   mutate(rank = rank(`Assessment_Date`))
# 
# family_intake <- family_intake %>%
#     mutate(Ethnicity= (fct_collapse(Ethnicity, "Other" = c("01. Alaskan Native / American Indian", "02. Asian", "03. Black / African American", "05. Vietnamese", "06. Pacific Islander", "08. Multiracial", "09. Other", "10. Don't know/Declined"))))
# 
# 
# family_intake <- family_intake %>%
#     mutate(Language= (fct_collapse(Language, "Other" = c("03. Mixteco", "05. Vietnamese", "07. Mandarin (Putonghua)", "09. Filipino(Tagalog)", "10. Other", "11. Arabic", "13. Chinese", "15. Unknown", "16. Decline to Answer", "06. Korean", "14. Other", "08. Farsi (Persian)", "12. Cambodian", "04. Hmong"))))
# 
# write_rds(preschool, "~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/preschooldatacleaned.rds")
# write_rds(family_intake, "~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/family_intakecleaned.rds")

preschool <- read_rds("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/preschooldatacleaned.rds")
family_intake <- read_rds("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/family_intakecleaned.rds")

```


```{r, echo=FALSE, include=FALSE}
ziptocity <- ziptocity %>% slice(1:53) %>% mutate(Zip = as.integer(`Zip Code`)) 

family_intake <- family_intake %>% ungroup() %>% mutate(Zip = as.integer(Zip))

family_intaketest <- family_intake %>% 
  right_join(ziptocity, family_intake, by = "Zip")

family_intaketest <- family_intaketest %>% filter(!is.na(ClientID)) 

family_intaketest <- family_intaketest %>% group_by(`ProgramTitle`, ClientID, Zip, school_year) %>% mutate(count = n()) %>% 
  mutate(rank = rank(`Assessment_Date`)) 

family_intaketest %>% 
  group_by(rank) %>% 
  summarise(count = n())

# notpre <- c("01: Preschool (Marina West)", "Preschool (Berylwood)", "Preschool (Hathaway School)", "Preschool (Sierra Linda)", "Preschool {Hueneme Head Start}", "Preschool {Larsen Head Start}", "Preschool {Little Vikings Head Start}", "Preschool {Parkview Head Start}")
# `%notin%` <- Negate(`%in%`)
# 
# preschool <- preschool %>% 
#   filter(`Service Modality` %notin% notpre)

preschool %>% 
  group_by(`Service Modality`) %>% 
  count(`Service Modality`)

preschool <- preschool %>% ungroup %>% mutate(dataset = "preschool") %>% mutate(Zip = as.integer(Zip))
family_intake <- family_intake %>% ungroup %>%  mutate(dataset = "family") %>% mutate(Zip = as.integer(Zip))

preschool2 <- preschool %>% filter(FamilyID!=0)
mergedpreschool <- left_join(preschool2, family_intake, by = c("FamilyID" = "FamilyID"))

mergedpreschool <- mergedpreschool %>% mutate(school_year = ifelse(school_year.x==school_year.y, 1, 0))

mergedpreschool %>% 
  ungroup() %>% 
  count(school_year)

mergedpreschool <- mergedpreschool %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`)) 

mergedpreschool %>% 
  group_by(school_year) %>% 
  count(rank)

mergedpreschool <- mergedpreschool %>% 
  mutate(dataset = ifelse(is.na(dataset.y), "preschool only", 
                   ifelse(dataset.y=="family", "family", "neither"))) 

mergedpreschool %>% 
  ungroup() %>% 
  count(dataset)

mergedpreschool %>% 
  filter(dataset=="family") %>% 
  group_by(school_year) %>% 
  count(count)

mergedpreschool %>% 
  filter(count==6) %>% 
  print()
```

```{r deduplicate, echo=FALSE, include=FALSE, warning=FALSE, message=FALSE}
distinct_rows <- mergedpreschool %>% select("ClientID.x","DOB.x", "school_year.x", "Service Modality", "Ethnicity.x", "Language.x", "Zip.x", "education", "wherelive", "education", "employment", "maritalstatus", "income", "householdmems", "school_year.y", "dataset") %>% distinct()

distinct_rows <- distinct_rows %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows %>% 
  filter(rank==1.5) %>% 
  print()

distinct_rows %>% 
  ungroup() %>% 
  count(rank)

distinct_rows <- distinct_rows %>% 
  mutate(double = ifelse(income=="No answer/prefer not to say" & count>1, "1", "0")) %>% 
  filter(double!=1)

distinct_rows <- distinct_rows %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows %>% 
  ungroup() %>% 
  count(rank)

distinct_rows <- distinct_rows %>% 
  select("ClientID.x","DOB.x", "school_year.x", "Ethnicity.x", "Language.x",  "Service Modality", "wherelive", "employment", "Zip.x", "maritalstatus", "income", "education", "householdmems", "Zip.x", "school_year.y", "dataset") %>% distinct()

distinct_rows <- distinct_rows %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows %>% 
  ungroup() %>% 
  count(rank)

distinct_rows <- distinct_rows %>% 
  mutate(double = ifelse(employment=="No answer/prefer not to say" & count>1, "1", "0")) %>% 
  filter(double!=1)

distinct_rows <- distinct_rows %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows %>% 
  ungroup() %>% 
  count(rank)

distinct_rows <- distinct_rows %>% 
  select("ClientID.x","DOB.x", "school_year.x", "Ethnicity.x", "Language.x", "Service Modality", "wherelive", "employment", "maritalstatus", "income", "education", "householdmems", "Zip.x", "school_year.y", "dataset") %>% distinct()

distinct_rows <- distinct_rows %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows <- distinct_rows %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.y`))

distinct_rows %>% ungroup() %>% count(rank)

distinct_rows <- distinct_rows %>% 
  filter(rank==1)

distinct_rows <- distinct_rows %>% 
  group_by(school_year.x, ClientID.x) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

# distinct_rows <- distinct_rows %>% 
#   filter(count==1) 

distinct_rows %>% 
  ungroup() %>% 
  count(income)

### merge client IDs where family ID is 0. 
preschool3 <- preschool %>% filter(FamilyID==0) 
mergedpreschool2 <- left_join(preschool3, family_intake, by = c("ClientID" = "ClientID"))

mergedpreschool2 <- mergedpreschool2 %>% mutate(school_year = ifelse(school_year.x==school_year.y, 1, 0))

mergedpreschool2 <- mergedpreschool2 %>% 
  group_by(school_year.x, ClientID) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`)) 

mergedpreschool2 <- mergedpreschool2 %>% 
  mutate(dataset = ifelse(is.na(dataset.y), "preschool only", 
                   ifelse(dataset.y=="family", "family", "neither"))) 

# unique_rows <- !duplicated(mergedpreschool[c("ClientID.x","DOB.x", "school_year.x", "Ethnicity.y", "Language.y", "education", "wherelive", "employment", "maritalstatus", "income", "householdmems")])

distinct_rows2 <- mergedpreschool2 %>% select("ClientID","DOB.x", "Service Modality", "school_year.x", "Ethnicity.x", "Language.x", "Zip.x", "education", "wherelive", "employment", "maritalstatus", "income", "householdmems", "school_year.y", "dataset") %>% distinct()

distinct_rows2 <- distinct_rows2 %>% 
  group_by(school_year.x, ClientID) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows2 %>% 
  filter(rank==1.5) %>% 
  print()

distinct_rows2 <- distinct_rows2 %>% 
  mutate(double = ifelse(income=="No answer/prefer not to say" & count>1, "1", "0")) %>% 
  filter(double!=1)

distinct_rows2 <- distinct_rows2 %>% 
  group_by(school_year.x, ClientID) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows2 <- distinct_rows2 %>% 
  select("ClientID","DOB.x", "school_year.x", "Ethnicity.x", "Language.x", "Service Modality", "wherelive", "employment", "education", "maritalstatus", "income", "householdmems", "Zip.x", "school_year.y", "dataset") %>% distinct()

distinct_rows2 <- distinct_rows2 %>% 
  group_by(school_year.x, ClientID) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows2 <- distinct_rows2 %>% 
  mutate(double = ifelse(employment=="No answer/prefer not to say" & count>1, "1", "0")) %>% 
  filter(double!=1)

distinct_rows2 <- distinct_rows2 %>% 
  group_by(school_year.x, ClientID) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rows2 <- distinct_rows2 %>% 
  select("ClientID","DOB.x", "school_year.x", "Ethnicity.x", "Language.x", "Service Modality", "wherelive", "employment", "education", "maritalstatus", "income", "householdmems", "Zip.x", "school_year.y", "dataset") %>% distinct()

distinct_rows2 <- distinct_rows2 %>% 
  group_by(school_year.x, ClientID) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.y`))

distinct_rows2 %>% 
  ungroup() %>% 
  count(rank)

distinct_rows2 <- distinct_rows2 %>% 
  filter(rank==1) 

distinct_rows2 %>% 
  ungroup() %>% 
  count(income)

distinct_rows <- distinct_rows %>% 
  rename(ClientID = ClientID.x)

distinct_rowstotal <- bind_rows(distinct_rows, distinct_rows2)

distinct_rowstotal <- distinct_rowstotal %>% 
  group_by(school_year.x, ClientID) %>% 
  mutate(count = n()) %>% 
  mutate(rank = rank(`school_year.x`))

distinct_rowstotal %>% 
  ungroup() %>% 
  count(count)

distinct_rowstotal <- distinct_rowstotal %>% 
  rename(school_year = school_year.x) %>% 
  rename(Ethnicity = Ethnicity.x) %>% 
  rename(Language = Language.x) %>% 
  rename(Zip = Zip.x)

distinct_rowstotal <- distinct_rowstotal %>% 
  group_by(ClientID) %>% 
  mutate(repeats = n()) %>% 
  mutate(rank = rank(`school_year`))

distinct_rowstotal %>% 
  ungroup() %>% 
  count(householdmems)


# sam wants a list of ids that do not merge 
# mergedids <- distinct_rowstotal %>% 
#   select(ClientID)
# 
# idvector <- mergedids[['ClientID']]
# 
# `%notin%` <- Negate(`%in%`)
# 
# preschoolnotmerged <- preschool %>% 
#   filter(ClientID %notin% idvector)

#write_csv(preschoolnotmerged, "~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/preschoolnotmerged.csv")

# familycombined%>% 
#   filter(ClientID==85476) %>% 
#   print()

preschooldistinct <- preschool %>% 
  group_by(FamilyID, ClientID, school_year) %>% 
  distinct()


preschooldistinct %>% 
   group_by(school_year) %>%
  summarise(count = n()) %>% 
   kable()

preschoolexp <- preschool %>% 
 mutate(month = month(`Enrollment Date_`)) %>% 
 mutate(year = year(`Enrollment Date_`)) %>% 
  group_by(ClientID, year, month) %>% 
  distinct()
  

preschoolexp %>% 
  ungroup() %>% 
  count(year, month) %>% 
  filter(year==2016 | year==2017)

distinct_rowstotal %>% ungroup() %>% count(income)

distinct_rowstotal <- distinct_rowstotal %>% 
  ungroup() %>% 
  mutate(income = factor(income)) %>% 
  mutate(employment = factor(employment))

distinct_rowstotal <- distinct_rowstotal %>% 
  mutate(employment = fct_collapse(employment, "Employed Full-Time" = c("Employed Full-Time", "Employed full-time"), 
                                   "Employed Part time" = c("Employed Part time", "Employed part-time"), 
                                   "No answer/prefer not to say" = c("No answer/prefer not to say", "No answer/Prefer not to say"), 
                                   "Seasonal Worker" = c("Seasonal Worker", "Seasonal worker"), 
                                  "Temporary Employment" = c("Temporary employment", "Temporary Employment")))

distinct_rowstotal <- distinct_rowstotal %>% 
  mutate(income = fct_collapse(income, "$10,000 less than $20,000" = c("$10,000 less than $20,000", "$10,000- less than $20,000"), 
                               "$20,000 less than $30,000" = c("$20,000 less than $30,000", "$20,000- less than $30,000"), 
                               "$30,000 less than $40,000" = c("$30,000 less than $40,000", "$30,000- less than $40,000"), 
                               "$40,000 less than $50,000" = c("$40,000 less than $50,000", "$40,000- less than $50,000"), 
                               "$50,000 less than $75,000" = c("$50,000 less than $75,000", "$50,000- less than $75,000"), 
                               "$75,000 less than $100,000" = c("$75,000 less than $100,000", "More than $75,000"), 
                               "No answer/prefer not to say" = c("No answer/prefer not to say", "No answer/Prefer not to say")))

distinct_rowstotal <- distinct_rowstotal %>%   
  mutate(income = fct_relevel(income, "Less than $10,000",  "$10,000 less than $20,000", "$20,000 less than $30,000", "$30,000 less than $40,000", "$40,000 less than $50,000", "$50,000 less than $75,000", "$75,000 less than $100,000", "More than $100,000", "No answer/prefer not to say"))

distinct_rowstotal <-  distinct_rowstotal %>%
  mutate(income2 = ifelse(income=="Less than $10,000", 5000, 
                   ifelse(income=="$10,000 less than $20,000", 15000, 
                   ifelse(income=="$20,000 less than $30,000", 25000, 
                   ifelse(income=="$30,000 less than $40,000", 35000, 
                   ifelse(income=="$40,000 less than $50,000", 45000, 
                   ifelse(income=="$50,000 less than $75,000", 62500, 
                   ifelse(income=="$75,000 less than $100,000", 87500, 
                   ifelse(income=="More than $100,000", 105000, NA)))))))))

distinct_rowstotal <- distinct_rowstotal %>% 
  mutate(fplguide = ifelse(householdmems==1, 12140, 
                    ifelse(householdmems==2, 16460, 
                    ifelse(householdmems==3, 20780, 
                    ifelse(householdmems==4, 25100, 
                    ifelse(householdmems==5, 29420, 
                    ifelse(householdmems==6, 33740, 
                    ifelse(householdmems==7, 38060, 
                    ifelse(householdmems==8, 42380, 
                    ifelse(householdmems==9, 46700, 
                    ifelse(householdmems==10, 51020, 
                    ifelse(householdmems==11, 55340, NA))))))))))))

distinct_rowstotal <- distinct_rowstotal %>% 
  mutate(fpl = (income2/fplguide)*100) %>% 
  filter(school_year>=2014) %>% 
  mutate(fpl2 = income2/fplguide)

distinct_rowstotal %>% ungroup() %>% count(education)

distinct_rowstotal <- distinct_rowstotal %>% 
  mutate(education = fct_collapse(education, "Less than high school" = c("No", "Less than high school"), 
                                  "High school diploma/GED or HIGHER" = c("Yes", "High school diploma/GED"), 
                                  "Some College" = c("Some College", "Associates Degree")))

# oxprelist <- c("01: Preschool (Marina West)", "Preschool (Berylwood)", "Preschool (Hathaway School)", "Preschool (Sierra Linda)", "Preschool {Hueneme Head Start}", "Preschool {Larsen Head Start}", "Preschool {Little Vikings Head Start}", "Preschool {Parkview Head Start}")
# `%notin%` <- Negate(`%in%`)
# 
# preschool <- preschool %>% 
#   filter(`Service Modality` %notin% notpre)

oxprelist <- c("04: Preschool (Sierra Linda)", "Preschool (Sierra Linda)", "02: Preschool (Harrington)", "Preschool (Harrington)", "06: Preschool (Elm)", "Preschool (Elm)", "Preschool (OSD)", "03: Preschool (Ramona)")

oxziplist <- c("93030", "93033", "93035", "93041")

distinct_rowstotal %>% ungroup() %>% count(`Service Modality`)

oxpre <- distinct_rowstotal %>% filter(`Service Modality` %in% oxprelist)

oxzip <- distinct_rowstotal %>% filter(Zip %in% oxziplist)

# write_rds(distinct_rowstotal, "~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/distinctrowstotal.rds")

```

<br>

![](../SI_Project_Template/template_files/report_template/SI_logo_new.png)

<br>

![](../SI_Project_Template/template_files/report_template/earth_map.jpeg)

#### A report prepared by the data science team on behalf of First 5 Ventura.

##### Pagebreak

# Executive Summary

We were asked to analyze data on preschool spots funded by First 5 Ventura, in order to understand the demographics of the preschool spots they funded. First 5 Ventura has two major data sets, one with information the preschool spots themselves and the preschool student demographic information, and one on preschool family demographics. These data sets are connected using family ID or client ID. Not every preschooler has matched data in the family demographics data set, so the demographics for preschool spots are more complete than the matched family demographics data set. 

We analyze the demographic data on preschool spots for three categories of the population: 

* All preschool spots funded by First 5 Ventura

* Preschoolers who attended preschool in the Oxnard School District: Sierra Linda, Harrington, Elm, Oxnard School District OSD, Ramona, and El Centrito SR

* Preschoolers in the Oxnard School District ZIP codes: 93030, 93033, 93035, and 93041

We then compare the Federal Poverty Level (FPL) of the First 5 Ventura ZIP codes to the FPL for the same ZIP codes in the 2015 American Community Survey, which is conducted by the US Census Bureau. 

## Overall Numbers

In the first table below, Table 1, we look at the total number of preschool spots funded by First 5 Ventura by School Year. First 5 Ventura has let us know that their data is most accurate for school years 2016-2017 and 2017-2018. These numbers closely mirror the number of preschool spots identified by First 5 Ventura.  

#### Table 1. Total Preschool Spots Served by First 5 Ventura by Year

```{r merged and deduplicated data, echo=FALSE}

distinct_rowstotal %>% 
   group_by(school_year) %>%
  summarise(count = n()) %>% 
 # mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Number of Students"))

```

<br>

The table below shows the number of preschoolers for whom we were able to match to family demographics. The difference between the whole data set and the matched data set is smallest for the most recent school years. 

#### Table 1.A Total Preschoolers matched to Family Intakes by Year

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(dataset=="family") %>% 
  group_by(school_year) %>% 
  summarise(count = n()) %>% 
 # mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Number of Students"))

```

<br>

## Ethnicity 

### First 5 Ventura: All Preschoolers

Table 2 shows the ethnicity of the preschoolers using the preschooler demographic data. The majority of preschoolers are Hispanic/Latino. 

#### Table 2. Total Ethnicity of Preschoolers

```{r table 2, echo=FALSE}

distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Ethnicity", "Number of Students", "Percent of Students"))

```
<br>

The graph below shows the same information as a bar graph.  

```{r, echo=FALSE}

distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=Ethnicity, y=perc)) +
  geom_col()+
  labs(x="Ethnicity", y="Percent") +
  ggtitle("Ethnicity by Preschoolers")

```

<br>

Table 3 shows ethnicity by school year. 

#### Table 3. Ethnicity by Year

```{r, echo=FALSE}

distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(school_year, Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Ethnicity", "Number of Students", "Percent of Students"))
```

### Oxnard School District Preschools

Table 2A shows the ethnicity of the preschoolers using the preschooler demographic data. The majority of preschoolers are Hispanic/Latino. 

#### Table 2A. Ethnicity of Preschoolers in Oxnard Preschools

```{r, echo=FALSE}

oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Ethnicity", "Number of Students", "Percent of Students"))

```
<br>

The graph below shows the same information as a bar graph.  

```{r, echo=FALSE}

oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=Ethnicity, y=perc)) +
  geom_col()+
  labs(x="Ethnicity", y="Percent") +
  ggtitle("Ethnicity by Preschoolers in Oxnard Preschools")

```

<br>

Table 3A shows ethnicity by school year for Oxnard preschools. 

#### Table 3A. Ethnicity by Year for Oxnard Preschools

```{r, echo=FALSE}

oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(school_year, Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Ethnicity", "Number of Students", "Percent of Students"))
```


### Oxnard School District ZIP codes

Table 2B shows the ethnicity of the preschoolers using the preschooler demographic data. The majority of preschoolers are Hispanic/Latino. 

#### Table 2B. Ethnicity of Preschoolers in Oxnard ZIP codes

```{r, echo=FALSE}

oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Ethnicity", "Number of Students", "Percent of Students"))

```
<br>

The graph below shows the same information as a bar graph.  

```{r, echo=FALSE}

oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=Ethnicity, y=perc)) +
  geom_col()+
  labs(x="Ethnicity", y="Percent") +
  ggtitle("Ethnicity by Preschoolers in Oxnard ZIP codes")

```

<br>

Table 3B shows ethnicity by school year for Oxnard ZIP codes. 

#### Table 3B. Ethnicity by Year for Oxnard ZIP codes

```{r, echo=FALSE}

oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Ethnicity)) %>% 
  group_by(school_year, Ethnicity) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Ethnicity", "Number of Students", "Percent of Students"))
```

<br>

## Language Spoken 

### First 5 Ventura: All Preschoolers

Table 4 shows the language spoken by the preschooler, taken from the preschool demographics. The majority of preschoolers speak English, but Spanish speakers are a large minority, with 40% of preschoolers speaking Spanish. 

#### Table 4. Total Language Spoken by First5 Ventura Preschoolers

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Language", "Number of Students", "Percent of Students"))
```
<br>

The graph below shows the same information in a bar graph. 

```{r, echo=FALSE}

distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=Language, y=perc)) +
  geom_col()+
  labs(x="Language", y="Percent") +
  ggtitle("Language Spoken by Preschoolers")
```


<br>

Table 5 shows the language spoken by the preschoolers per school year. 

#### Table 5. Language Spoken by Year 

```{r, echo=FALSE}

distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(school_year, Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Language", "Number of Students", "Percent of Students"))
```

<br>

### Oxnard School District Preschools

Table 4A shows the language spoken by the preschooler in Oxnard School District preschools, taken from the preschool demographics. The majority of preschoolers speak English, but Spanish speakers are a large minority, with 40% of preschoolers speaking Spanish. 

#### Table 4A. Language Spoken by First5 Ventura Preschoolers in Oxnard School District Preschools

```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Language", "Number of Students", "Percent of Students"))
```
<br>

The graph below shows the same information in a bar graph. 

```{r, echo=FALSE}

oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=Language, y=perc)) +
  geom_col()+
  labs(x="Language", y="Percent") +
  ggtitle("Language Spoken by Preschoolers in Oxnard School District Preschools")
```


<br>

Table 5A shows the language spoken by the preschoolers per school year. 

#### Table 5A. Language Spoken by Year for Preschoolers in Oxnard School District Preschools

```{r, echo=FALSE}

oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(school_year, Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Language", "Number of Students", "Percent of Students"))
```


<br>

### Oxnard School District ZIP codes

Table 4B shows the language spoken by the preschooler in Oxnard School District ZIP codes, taken from the preschool demographics. The majority of preschoolers speak English, but Spanish speakers are a large minority, with 40% of preschoolers speaking Spanish. 

#### Table 4B. Language Spoken by First5 Ventura Preschoolers in Oxnard School District ZIP codes

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Language", "Number of Students", "Percent of Students"))
```
<br>

The graph below shows the same information in a bar graph. 

```{r, echo=FALSE}

oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=Language, y=perc)) +
  geom_col()+
  labs(x="Language", y="Percent") +
  ggtitle("Language Spoken by Preschoolers in Oxnard School District ZIP codes")
```


<br>

Table 5B shows the language spoken by the preschoolers per school year. 

#### Table 5B. Language Spoken by Year for Preschoolers in Oxnard School District ZIP codes

```{r, echo=FALSE}

oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(Language)) %>% 
  group_by(school_year, Language) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Language", "Number of Students", "Percent of Students"))
```

<br>

## Income

### First 5 Ventura: All Preschoolers

Table 6 shows the family income reported in the family demographic files for the preschoolers served by First 5 Ventura. The bulk of the students are in families with incomes less than $50,000.

#### Table 6. Income for First 5 Ventura Preschoolers

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
  group_by(income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Income", "Number of Students", "Percent of Students"))
```
<br>

The following bar chart shows the same information. 

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
    filter(income!="No answer/prefer not to say") %>% 
  group_by(income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=income, y=perc)) +
  geom_col()+
  labs(x="income", y="Percent") +
  ggtitle("Family Income")
```

<br>

Table 7 shows the preschool family income by school year. 

#### Table 7. Income by Year

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
  group_by(school_year, income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("School Year", "Income", "Number of Students", "Percent of Students"))


```
<br>

### Oxnard School District Preschools

Table 6A shows the family income reported in the family demographic files for the preschoolers served by First 5 Ventura in the Oxnard School District preschools. The bulk of the students are in families with incomes less than $50,000.

#### Table 6A. Income for Oxnard School District Preschools

```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
  group_by(income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Income", "Number of Students", "Percent of Students"))
```
<br>

The following bar chart shows the same information. 

```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
    filter(income!="No answer/prefer not to say") %>% 
  group_by(income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=income, y=perc)) +
  geom_col()+
  labs(x="income", y="Percent") +
  ggtitle("Family Income for Oxnard School District Preschools")
```

<br>

Table 7A shows the preschool family income by school year for those in the Oxnard School District preschools. 

#### Table 7A. Income by Year for Oxnard School District Preschools

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
  group_by(school_year, income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("School Year", "Income", "Number of Students", "Percent of Students"))


```

### Oxnard School District ZIP codes

Table 6B shows the family income reported in the family demographic files for the preschoolers served by First 5 Ventura in Oxnard School District ZIP codes. The bulk of the students are in families with incomes less than $50,000.

#### Table 6B. Income for Oxnard District ZIP codes

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
  group_by(income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("Income", "Number of Students", "Percent of Students"))
```
<br>

The following bar chart shows the same information. 

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
    filter(income!="No answer/prefer not to say") %>% 
  group_by(income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  ggplot(aes(x=income, y=perc)) +
  geom_col()+
  labs(x="income", y="Percent") +
  ggtitle("Family Income for Oxnard School District ZIP codes")
```

<br>

Table 7B shows the preschool family income by school year. 

#### Table 7B. Income by Year for Oxnard District ZIP codes

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(income)) %>% 
  group_by(school_year, income) %>%
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
   kable(., col.names = c("School Year", "Income", "Number of Students", "Percent of Students"))


```

## Household Members

### Fist 5 Ventura: All Preschoolers

<br>

Table 8 shows the mean household members reported in the family demographic files for the preschoolers served by First 5 Ventura. 

#### Table 8. Mean Household Members for First 5 Ventura Preschoolers

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  ungroup %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
   kable(., col.names = c("Mean Household Members"))
```

<br>

Table 9 shows the mean household members for each preschooler by school year. 

#### Table 9. Mean Household Members by School Year

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  group_by(school_year) %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
   kable(., col.names = c("School Year", "Mean Household Members"))
```
 <br>
 
 The bar graph below shows the same information. 

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  group_by(school_year) %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
  ggplot(aes(x=school_year, y=meanHouseholdMembers)) +
  geom_col()+
  labs(x="School Year", y="Mean Household Members") +
  ggtitle("Mean Household Members by School Year")
```

<br>

### Oxnard School District Preschools

Table 8A shows the mean household members reported in the family demographic files for the preschoolers served by First 5 Ventura in Oxnard School district preschools. 

#### Table 8A. Mean Household Members for Oxnard School District Preschools

```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  ungroup %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
   kable(., col.names = c("Mean Household Members"))
```

<br>

Table 9A shows the mean household members for each preschooler by school year in Oxnard School district preschools. 

#### Table 9A. Mean Household Members by School Year for Oxnard School District Preschools

```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  group_by(school_year) %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
   kable(., col.names = c("School Year", "Mean Household Members"))
```
 <br>
 
 The bar graph below shows the same information. 

```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  group_by(school_year) %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
  ggplot(aes(x=school_year, y=meanHouseholdMembers)) +
  geom_col()+
  labs(x="School Year", y="Mean Household Members") +
  ggtitle("Mean Household Members by School Year for Oxnard School District Preschools")
```

<br>

### Oxnard School District ZIP codes

Table 8B shows the mean household members reported in the family demographic files for the preschoolers served by First 5 Ventura in Oxnard School District ZIP codes. 

#### Table 8B. Mean Household Members for Oxnard School District ZIP codes

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  ungroup %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
   kable(., col.names = c("Mean Household Members"))
```

<br>

Table 9B shows the mean household members for each preschooler by school year in Oxnard School District ZIP codes. 

#### Table 9B. Mean Household Members by School Year for Oxnard School District ZIP codes

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  group_by(school_year) %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
   kable(., col.names = c("School Year", "Mean Household Members"))
```
 <br>
 
 The bar graph below shows the same information. 

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(householdmems)) %>% 
  group_by(school_year) %>% 
  mutate(householdmems = as.numeric(householdmems)) %>% 
  summarise(meanHouseholdMembers = mean(householdmems, na.rm = TRUE)) %>% 
  ggplot(aes(x=school_year, y=meanHouseholdMembers)) +
  geom_col()+
  labs(x="School Year", y="Mean Household Members") +
  ggtitle("Mean Household Members by School Year for Oxnard School District ZIP codes")
```

<br> 

## Employment

### First 5 Ventura: All Preschoolers

Table 10 shows that 45% of parents reported being employed full-time as captured in the family demographic files for the preschoolers served by First 5 Ventura. In the US population as a whole, the BLS reports that 88% of people over the age of 20 are employed full-time ([https://www.bls.gov/cps/cpsaat08.htm]). 

#### Table 10. Employment for Preschool Family
```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  count(employment) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  kable(., col.names = c("Employment", "Number of Households", "Percent of Households") )

```

<br>

The graph below shows the same information as a bar graph. 

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  count(employment) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  ggplot(aes(x=employment, y=perc)) +
  geom_col()+
  labs(x="Employment", y="Percent") +
  ggtitle("Employment for Preschool Family")
```

<br> 

Table 11 shows that the number of parents reporting being employed full-time has increased over time, from 44% in 2014-2015 to 49% in 2017-2018. 

#### Table 11. Employment for Preschool Family
```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, employment) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Employment", "Number of Households", "Percent of Households") )

```

<br>

The graph below shows the number of parents reporting being employed full-time has increased from 2014-2015 to 2017-2018. 

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, employment) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(employment=="Employed Full-Time") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Employed Full-Time by Year")

```

<br>

### Oxnard School District Preschools

Table 10A shows that 35% of parents reported being employed full-time as captured in the family demographic files for the preschoolers in the Oxnard School District preschools. In the US population as a whole, the BLS reports that 88% of people over the age of 20 are employed full-time ([https://www.bls.gov/cps/cpsaat08.htm]). 

#### Table 10A. Employment for Preschool Families in Oxnard School District Preschools
```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  count(employment) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  kable(., col.names = c("Employment", "Number of Households", "Percent of Households") )

```

<br>

The graph below shows the same information as a bar graph. 

```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  count(employment) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  ggplot(aes(x=employment, y=perc)) +
  geom_col()+
  labs(x="Employment", y="Percent") +
  ggtitle("Employment for Preschool Family")
```

<br> 

Table 11A shows that the number of parents reporting being employed full-time has increased slightly over time, from 32% in 2014-2015 to 37% in 2017-2018. 

#### Table 11A. Employment for Preschool Families in Oxnard School District Preschools
```{r, echo=FALSE}
oxpre %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, employment) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Employment", "Number of Households", "Percent of Households") )

```

<br>

The graph below shows the number of parents reporting being employed full-time has increased slightly from 2014-2015 to 2017-2018. 

```{r, echo=FALSE}
oxpre %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, employment) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(employment=="Employed Full-Time") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Employed Full-Time by Year in Oxnard SD Preschools")

```

<br>

### Oxnard School District ZIP codes

Table 10B shows that 44% of parents reported being employed full-time as captured in the family demographic files for the preschoolers in the Oxnard School District ZIP codes. In the US population as a whole, the BLS reports that 88% of people over the age of 20 are employed full-time ([https://www.bls.gov/cps/cpsaat08.htm]). 

#### Table 10B. Employment for Preschool Families in Oxnard School District Preschools
```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  count(employment) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  kable(., col.names = c("Employment", "Number of Households", "Percent of Households") )

```

<br>

The graph below shows the same information as a bar graph. 

```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  count(employment) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  ggplot(aes(x=employment, y=perc)) +
  geom_col()+
  labs(x="Employment", y="Percent") +
  ggtitle("Employment for Preschool Families in Oxarnd SD ZIP codes")
```

<br> 

Table 11B shows that the number of parents reporting being employed full-time has increased slightly over time, from 40% in 2014-2015 to 46% in 2017-2018. 

#### Table 11B. Employment for Preschool Families in Oxnard School District ZIP codes
```{r, echo=FALSE}
oxzip %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, employment) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Employment", "Number of Households", "Percent of Households") )

```

<br>

The graph below shows the number of parents reporting being employed full-time has increased slightly from 2014-2015 to 2017-2018. 

```{r, echo=FALSE}
oxzip %>% 
  filter(!is.na(employment)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, employment) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(employment=="Employed Full-Time") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Employed Full-Time by Year in Oxnard SD ZIP codes")

```

<br> 

## Marital Status

### First 5 Ventura: All Preschoolers

Table 12 shows that only 12% of the preschoolers served by First 5 Ventura are in single parent households. 

#### Table 12. Marital Status of Preschool Family
```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  count(maritalstatus) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  kable(., col.names = c("Marital Status", "Number of Households", "Percent of Households") )

```

<br> 

Table 13 shows that the number of preschoolers served by First 5 Ventura who are in single parent households has stayed relatively steady since 2014-2015. 

#### Table 13. Marital Status of Preschool Family
```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, maritalstatus) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Marital Status", "Number of Households", "Percent of Households") )

```
 <br>
 
 The bar graph below shows the percent of single parent households by year. 

```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, maritalstatus) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(maritalstatus=="Single parent household") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Single Parent Households by Year")

```
<br>

### Oxnard School District Preschools

Table 12A shows that only 26% of the preschoolers served by First 5 Ventura in Oxnard School District preschools are in single parent households, which is twice as many as in the First 5 Ventura population overall. 

#### Table 12A. Marital Status of Preschool Families in Oxnard SD Preschools
```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  count(maritalstatus) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  kable(., col.names = c("Marital Status", "Number of Households", "Percent of Households") )

```

<br> 

Table 13A shows that the number of preschoolers served by First 5 Ventura in Oxnard School District preschools who are in single parent households has increased steadily since 2014-2015. 

#### Table 13A. Marital Status of Preschool Families in Oxnard SD Preschools
```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, maritalstatus) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Marital Status", "Number of Households", "Percent of Households") )

```
 <br>
 
 The bar graph below shows the percent of single parent households increasing by year. 

```{r, echo=FALSE}
oxpre %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, maritalstatus) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(maritalstatus=="Single parent household") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Single Parent Households by Year in Oxnard SD Preschools")

```
<br>

### Oxnard School District ZIP codes

Table 12B shows that only 19% of the preschoolers served by First 5 Ventura in Oxnard School District ZIP codes are in single parent households. 

#### Table 12B. Marital Status of Preschool Families in Oxnard SD ZIP codes
```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  count(maritalstatus) %>% 
  mutate(perc=(n/sum(n)*100)) %>% 
  kable(., col.names = c("Marital Status", "Number of Households", "Percent of Households") )

```

<br> 

Table 13B shows that the number of preschoolers served by First 5 Ventura in Oxnard School District preschools who are in single parent households has increased slightly since 2014-2015. 

#### Table 13B. Marital Status of Preschool Families in Oxnard SD ZIP codes
```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, maritalstatus) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Marital Status", "Number of Households", "Percent of Households") )

```
 <br>
 
 The bar graph below shows the percent of single parent households increased slightly in the last year. 

```{r, echo=FALSE}
oxzip %>% 
  filter(!is.na(maritalstatus)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, maritalstatus) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(maritalstatus=="Single parent household") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Single Parent Households by Year in Oxnard SD ZIP codes")

```

<br> 

## Education

### First 5 Ventura: All Preschoolers

Table 14 shows about one quarter of the parents who answered the demographic questionnaire have less than a high school education. In the US as a whole, 88% of people over 25 have a high school diploma/GED or more. https://www.census.gov/content/dam/Census/library/publications/2016/demo/p20-578.pdf

#### Table 14. Educational Attainment of Preschool Family 
```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("Education", "Number of Households", "Percent of Households") )

```

<br> 

Table 15 shows the education of parents who answered the demographic questionnaire by year. The percent of preschool families with a parent who has less than a high school education is 35% in year 2014-2015, but decreases all the way down to 14% in year 2017-2018, which is a similar percent to the US population as a whole. 

#### Table 15. Educational Attainment of Preschool Family by Year
```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Education", "Number of Households", "Percent of Households") )

```

<br> 

The bar graph below shows the number of parents who answered the demographic questionnaire who have less than a high school education by year. The number of parents with less than a high school education has decreased year over year. 

#### Educational Attainment of Preschool Family by Year
```{r, echo=FALSE}
distinct_rowstotal %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(education=="Less than high school") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Less than High School by Year")
```
<br>

### Oxnard School District Preschools

Table 14A shows 40% of the parents who answered the demographic questionnaire in Oxnard School District preschools have less than a high school education, which is much higher than the general First 5 Ventura population as a whole. In the US, an estimated 88% of people over 25 have a high school diploma/GED or more. https://www.census.gov/content/dam/Census/library/publications/2016/demo/p20-578.pdf

#### Table 14A. Educational Attainment of Preschool Families in Oxnard School District Preshools
```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("Education", "Number of Households", "Percent of Households") )

```

<br> 

Table 15A shows the education of parents who answered the demographic questionnaire by year for Oxnard School District preschools. The percent of preschool families with a parent who has less than a high school education is 47% in year 2014-2015, but decreases all the way down to 30% in year 2017-2018, however, that is still much higher than the total US population. 

#### Table 15A. Educational Attainment of Preschool Families by Year in Oxnard SD Preschools
```{r, echo=FALSE}
oxpre %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Education", "Number of Households", "Percent of Households") )

```

<br> 

The bar graph below shows the number of parents who answered the demographic questionnaire who have less than a high school education by year. The number of parents with less than a high school education has decreased year over year, but is still substantially higher than the US population. 

#### Educational Attainment of Preschool Families by Year in Oxnard SD Preschools
```{r, echo=FALSE}
oxpre %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(education=="Less than high school") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Less than High School by Year in Oxnard SD Preschools")
```
<br>

### Oxnard School District ZIP codes

Table 14B shows 32% of the parents who answered the demographic questionnaire in Oxnard School District ZIP codes have less than a high school education, which is much higher than the general First 5 Ventura population as a whole. In the US, an estimated 88% of people over 25 have a high school diploma/GED or more. https://www.census.gov/content/dam/Census/library/publications/2016/demo/p20-578.pdf

#### Table 14B. Educational Attainment of Preschool Families in Oxnard School District ZIP codes
```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("Education", "Number of Households", "Percent of Households") )

```

<br> 

Table 15B shows the education of parents who answered the demographic questionnaire by year. The percent of preschool families with a parent who has less than a high school education is 42% in year 2014-2015, but decreases all the way down to 22% in year 2017-2018, however, that is still much higher than the total US population. 

#### Table 15B. Educational Attainment of Preschool Families by Year in Oxnard SD Preschools
```{r, echo=FALSE}
oxzip %>% 
  filter(school_year>=2014) %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  kable(., col.names = c("School Year", "Education", "Number of Households", "Percent of Households") )

```

<br> 

The bar graph below shows the number of parents who answered the demographic questionnaire who have less than a high school education by year. The number of parents with less than a high school education has decreased year over year, but is still substantially higher than the US population. 

#### Educational Attainment of Preschool Families by Year in Oxnard SD Preschools
```{r, echo=FALSE}
oxzip %>% 
  filter(!is.na(education)) %>% 
 # group_by(school_year) %>% 
  group_by(school_year, education) %>% 
  summarise(count = n()) %>% 
  mutate(perc=(count/sum(count)*100)) %>% 
  filter(education=="Less than high school") %>% 
  ggplot(aes(x=school_year, y=perc)) +
  geom_col()+
  labs(x="Year", y="Percent") +
  ggtitle("Percent Less than High School by Year in Oxnard SD ZIP codes")
```


##### Pagebreak

### Census Comparisons to First 5 Ventura Population

First 5 Ventura was interested in comparing the families they serve with the general census population in the same ZIP codes. We took federal poverty level (FPL) data from the 2015 American Census Survey (ACS) and compared it to the First 5 Ventura FPL data across the same ZIP codes. Using the income and household member data in the First 5 Ventura family demographics data, we were able to calculate federal poverty level for each family for whom we had data. The ACS has estimates on the number of families in each Zip Code that are at a certain percent of the Federal Poverty Line (FPL). The graphs below compare the federal poverty line data for First 5 Ventura to the ACS data. We find that First 5 Ventura is serving a population that is much further below the FPL than the general population.   


```{r compare to ACS, echo=FALSE, warning=FALSE, message=FALSE}

library(acs)
library(tigris)

# zipcodes <- distinct_rowstotal %>% ungroup() %>% select(Zip) %>% distinct() %>% filter(Zip!=0) %>% filter(!is.na(Zip))
# 
# zipcodes <- as.vector(zipcodes)
# 
# # zipcodes <- zctas(starts_with = c("91", "93"))
# # counties <- c(111) # FIPS for Ventura
# 
# # install api key using key you get from census website
# api.key.install(key="4d87536be3f8a2bc1536749b1b3f53cb869d6e54")
# api.key.migrate()
# 
# #create a geographic set to grab tabular data 
# geo <- geo.make(zip.code=zipcodes) 
# 
# #update endyear to 2015
# 
# table <- acs.fetch(endyear = 2015, span = 5, geography = geo, 
#                      table.number = "C17002", col.names = "pretty")
# 
acstable <- read_csv("~/Google Drive/SI/DataScience/Side projects/Ventura Preschool /raw_data/acs2016_5yr_Poverty level.csv")

acstable <- acstable %>% rename(Zip = name) %>% mutate(Group = "ACS")

distinct_rowstotal2 <- distinct_rowstotal %>% 
  filter(!is.na(income) & !is.na(householdmems)) %>% 
  mutate("Under .50" = ifelse(fpl2<=0.50, 1, 0)) %>% 
  mutate(".50 to .99" = ifelse(fpl2>0.50 & fpl2<=0.99, 1, 0)) %>% 
  mutate("1.00 to 1.24" = ifelse(fpl2>=1.00 & fpl2<=1.24, 1, 0)) %>% 
  mutate("1.25 to 1.49" = ifelse(fpl2>=1.25 & fpl2<=1.49, 1, 0)) %>% 
  mutate("1.50 to 1.84" = ifelse(fpl2>=1.50 & fpl2<=1.84, 1, 0)) %>% 
  mutate("1.85 to 1.99" = ifelse(fpl2>=1.85 & fpl2<=1.99, 1, 0)) %>% 
  mutate("2.00 and over" = ifelse(fpl2>=2.00, 1, 0))

sumofall <- distinct_rowstotal2 %>% 
  ungroup() %>% 
  filter(Zip!=0) %>% 
  filter(!is.na(Zip)) %>% 
  select(Zip, 23:29) %>% 
  group_by(Zip) %>% 
  summarise(`Under .50` = sum(`Under .50`, na.rm = TRUE), ".50 to .99" = sum(`.50 to .99`, na.rm = TRUE), "1.00 to 1.24" = sum(`1.00 to 1.24`, na.rm = TRUE),  "1.25 to 1.49" = sum(`1.25 to 1.49`, na.rm = TRUE), "1.50 to 1.84" = sum(`1.50 to 1.84`, na.rm = TRUE), "1.85 to 1.99" = sum(`1.85 to 1.99`, na.rm = TRUE), "2.00 and over" = sum(`2.00 and over`, na.rm = TRUE)) %>% 
  mutate(Group = "NfLFirst5")
  
comparison <- bind_rows(acstable, sumofall)

comparison <- comparison %>% 
  rowwise() %>% 
  mutate(totalnfl = sum(c(`Under .50`, `.50 to .99`, `1.00 to 1.24`, `1.25 to 1.49`, `1.50 to 1.84`, `1.85 to 1.99`, `2.00 and over`))) 

comparisonpercent <- comparison %>% 
  ungroup() %>% 
  mutate(Under50 = `Under .50`/totalnfl, "50to99" = `.50 to .99`/totalnfl, "1to124" = `1.00 to 1.24`/totalnfl, "125to149" = `1.25 to 1.49`/totalnfl, "150to184" = `1.50 to 1.84`/totalnfl, "185to199" = `1.85 to 1.99`/totalnfl, "200andover" = `2.00 and over`/totalnfl) %>% 
    mutate(Under50 = `Under .50`/totalnfl, "50to99" = `.50 to .99`/totalnfl, "1to124" = `1.00 to 1.24`/totalnfl, "125to149" = `1.25 to 1.49`/totalnfl, "150to184" = `1.50 to 1.84`/totalnfl, "185to199" = `1.85 to 1.99`/totalnfl, "200andover" = `2.00 and over`/totalnfl) %>% 
  select(Zip, Group, 21:27)

comparisonpercent %>% 
  ungroup() %>% 
  ggplot(aes(x=Group, y=Under50)) +
  geom_point() +
  geom_boxplot() +
  labs(y = "% Under .5 w/in All Zips", x = "") +
  ggtitle("ACS vs First5 Ventura Under .50 of FPL")

comparisonpercent %>% 
  ungroup() %>% 
  ggplot(aes(x=Group, y=`50to99`)) +
  geom_point() +
  geom_boxplot() +
  labs(y = "% .5 to .99 w/in All Zips", x = "") +
  ggtitle("ACS vs First5 Ventura .50 to .99 of FPL")

comparisonpercent %>% 
  ungroup() %>% 
  ggplot(aes(x=Group, y=`1to124`)) +
  geom_point() +
  geom_boxplot() +
  labs(y = "% 1 to 1.24 w/in All Zips", x = "") +
  ggtitle("ACS vs First5 Ventura 1 to 1.24 of FPL")

comparisonpercent %>% 
  ungroup() %>% 
  ggplot(aes(x=Group, y=`125to149`)) +
  geom_point() +
  geom_boxplot() +
  labs(y = "% 1.25 to 1.49 w/in All Zips", x = "") +
  ggtitle("ACS vs First5 Ventura 1.25 to 1.49 of FPL")

comparisonpercent %>% 
  ungroup() %>% 
  ggplot(aes(x=Group, y=`150to184`)) +
  geom_point() +
  geom_boxplot() +
  labs(y = "% 1.5 to 1.84 w/in All Zips", x = "") +
  ggtitle("ACS vs First5 Ventura 1.50 to 1.84 of FPL")

comparisonpercent %>% 
  ungroup() %>% 
  ggplot(aes(x=Group, y=`185to199`)) +
  geom_point() +
  geom_boxplot() +
  labs(y = "% 1.85 to 1.99 w/in All Zips", x = "") +
  ggtitle("ACS vs First5 Ventura 1.85 to 1.99 of FPL")

comparisonpercent %>% 
  ungroup() %>% 
  ggplot(aes(x=Group, y=`200andover`)) +
  geom_point() +
  geom_boxplot() +
  labs(y = "% Over 200% w/in All Zips", x = "") +
  ggtitle("ACS vs First5 Ventura for Over 200% of FPL")

comparisonpercent %>%
  filter(Group=="NfLFirst5") %>% 
  arrange(Zip) %>%
  kable()

```

